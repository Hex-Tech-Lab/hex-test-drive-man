#!/usr/bin/env sh
if [ -f ~/.huskyrc ]; then
  . ~/.huskyrc
fi

# Add pnpm to PATH
export PATH="/home/kellyb_dev/.local/bin:$PATH"

# Defensive check: Ensure pnpm is available before running checks
if ! command -v pnpm > /dev/null 2>&1; then
  echo ""
  echo "‚ùå ERROR: pnpm not found in PATH"
  echo ""
  echo "Pre-commit hook requires pnpm to run docstring checks."
  echo ""
  echo "Fix options:"
  echo "  1. Install pnpm globally:"
  echo "     npm install -g pnpm"
  echo "     # OR"
  echo "     curl -fsSL https://get.pnpm.io/install.sh | sh -"
  echo ""
  echo "  2. Skip this hook (EMERGENCY ONLY):"
  echo "     git commit --no-verify"
  echo ""
  echo "See SECURITY_NOTES.md section 5 for full setup instructions."
  echo ""
  exit 1
fi

# Run docstring coverage check
pnpm run check:docstrings
